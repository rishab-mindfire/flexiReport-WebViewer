<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>JS FileMaker-Style Report Builder</title>
    <!-- Intract js -->
    <script src="https://cdn.jsdelivr.net/npm/interactjs/dist/interact.min.js"></script>
    <!-- App CSS -->
    <link rel="stylesheet" href="../layout/style.css" />
  </head>
  <body>
    <div id="toolbar">
      <strong>Report Builder</strong>
      <button class="secondary" onclick="app.loadDataFromAPI()">
        Load data
      </button>
      <button onclick="app.generatePreview()">â–¶ Preview</button>
      <button class="secondary" onclick="app.saveSchema()">Save JSON</button>
      <button class="secondary" onclick="app.loadFromPrompt()">
        ðŸ“‚ Load JSON
      </button>
      <button class="secondary" onclick="app.showFullPreviewHTML()">
        Get Full Preview HTML
      </button>
    </div>
    <div id="workspace">
      <div id="toolbox">
        <strong>Keep Parts</strong>
        <label><input id="keep-header" type="checkbox" checked /> Header</label>
        <label><input id="keep-body" type="checkbox" checked /> Body</label>
        <label><input id="keep-footer" type="checkbox" checked /> Footer</label>
        <h3>Fields</h3>
        <div id="fields-list"></div>
        <h3>Static</h3>
        <div class="tool-item tool-label" draggable="true" data-type="label">
          Text Label
        </div>
        <h3>Calculations</h3>
        <div
          class="tool-item tool-calc"
          draggable="true"
          data-type="calculation"
          data-function="SUM">
          SUM
        </div>
        <div
          class="tool-item tool-calc"
          draggable="true"
          data-type="calculation"
          data-function="AVG">
          AVG
        </div>
      </div>
      <div id="canvas-wrapper">
        <div class="design-page">
          <div
            id="part-header"
            class="part"
            data-part="header"
            data-label="Header">
            <div class="resize-handle"></div>
          </div>
          <div id="part-body" class="part" data-part="body" data-label="Body">
            <div class="resize-handle"></div>
          </div>
          <div
            id="part-footer"
            class="part"
            data-part="footer"
            data-label="Footer">
            <div class="resize-handle"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- Preview Modal -->
    <div id="preview-modal">
      <div id="preview-content-wrapper">
        <div id="preview-toolbar">
          <button
            class="secondary"
            onclick="document.getElementById('preview-modal').style.display='none'">
            Close
          </button>
        </div>
        <div id="preview-content"></div>
      </div>
    </div>

    <!-- HTML EXPORT MODAL -->
    <div
      id="html-modal"
      style="
        display: none;
        position: fixed;
        inset: 0;
        background: rgba(0, 0, 0, 0.6);
        z-index: 9999;
        align-items: center;
        justify-content: center;
      ">
      <div
        style="
          background: #fff;
          width: 80%;
          max-width: 900px;
          padding: 12px;
          border-radius: 6px;
          display: flex;
          flex-direction: column;
        ">
        <h3 style="margin: 0 0 8px">Full Preview HTML</h3>

        <textarea
          id="html-content"
          spellcheck="false"
          style="
            width: 100%;
            height: 320px;
            font-family: monospace;
            font-size: 12px;
          "></textarea>

        <div style="margin-top: 8px; text-align: right">
          <button onclick="app.copyPreviewHTML()">Copy</button>
          <button
            class="secondary"
            onclick="document.getElementById('html-modal').style.display='none'">
            Close
          </button>
        </div>
      </div>
    </div>

    <!-- APP JS -->
    <script src="../layout/index.js"></script>
  </body>
</html>
